{"remainingRequest":"/Users/shizhonghua/workspace/sell/node_modules/babel-loader/lib/index.js!/Users/shizhonghua/workspace/sell/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/shizhonghua/workspace/sell/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shizhonghua/workspace/sell/src/views/user/roles/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/shizhonghua/workspace/sell/src/views/user/roles/index.vue","mtime":1561425821000},{"path":"/Users/shizhonghua/workspace/sell/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shizhonghua/workspace/sell/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/shizhonghua/workspace/sell/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shizhonghua/workspace/sell/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/shizhonghua/workspace/sell/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport createRoleEditDialog from \"./createRoleEditDialog\";\nimport authorityEditDialog from \"./authorityEditDialog\";\nimport { getRoleList, roleModify, roleSwitch, roleAdd } from '@/http/api/rolesApi';\nimport { getAuthorityList } from '@/http/api/authorityApi';\nexport default {\n  components: {\n    createRoleEditDialog: createRoleEditDialog,\n    authorityEditDialog: authorityEditDialog\n  },\n  data: function data() {\n    return {\n      disable: false,\n      pageIndex: 1,\n      pageSize: 10,\n      totalCount: 0,\n      allRoleList: [],\n      roleAuthority: {}\n    };\n  },\n  computed: {\n    showList: function showList() {\n      var pageIndex = this.pageIndex,\n          pageSize = this.pageSize,\n          allRoleList = this.allRoleList;\n      return allRoleList.slice((pageIndex - 1) * pageSize, pageIndex * pageSize);\n    }\n  },\n  mounted: function mounted() {\n    this.getContent();\n  },\n  methods: {\n    getContent: function getContent() {\n      var _this = this;\n\n      getRoleList().then(function (res) {\n        _this.allRoleList = res;\n        _this.totalCount = res.length;\n      });\n    },\n    itemChange: function itemChange() {\n      var _this2 = this;\n\n      var _ref = arguments.length <= 0 ? undefined : arguments[0],\n          id = _ref.id,\n          name = _ref.name,\n          enable = _ref.enable,\n          version = _ref.version;\n\n      if (arguments.length <= 1 ? undefined : arguments[1]) {\n        this.roleAuthority = {\n          rid: id,\n          name: name,\n          enable: enable\n        };\n        getAuthorityList(id).then(function (res) {\n          _this2.$refs.authorityEditDialog.open(res);\n        });\n      } else {\n        var str = enable ? this.$t('CloseRole') : this.$t('OpenRole');\n        this.$confirm(str + '   ' + name).then(function () {\n          roleSwitch({\n            id: id,\n            enable: !enable,\n            name: name,\n            version: version\n          }).then(function () {\n            _this2.$message.success(enable ? _this2.$t('CloseRoleSuccess') : _this2.$t('OpenRoleSuccess'));\n\n            _this2.getContent(_this2.pageIndex);\n          });\n        }).catch(function (err) {\n          _this2.$message.error(err.body.message);\n        });\n      }\n    },\n    handleCurrentChange: function handleCurrentChange(pageIndex) {\n      this.pageIndex = pageIndex;\n      this.getContent(pageIndex);\n    },\n    getPageData: function getPageData(result) {\n      var _this3 = this;\n\n      var data = result.data,\n          code = result.code;\n\n      if (code) {\n        roleModify(_objectSpread({}, this.roleAuthority, {\n          menuList: data\n        })).then(function () {\n          _this3.$message.success(_this3.$t('RoleAuthorization'));\n\n          _this3.getContent(_this3.pageIndex);\n        }).catch(function (err) {\n          _this3.$message.error(err.body.message);\n        });\n      } else {\n        roleAdd(data).then(function () {\n          _this3.$message.success(_this3.$t('RoleCreate'));\n\n          _this3.getContent();\n        }).catch(function (err) {\n          _this3.$message.error(err.body.message);\n        });\n      }\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"content-wrapper\">\n    <el-card>\n      <el-button type=\"primary\" size=\"medium\" @click=\"$refs.createRoleEditDialog.open()\">\n        {{ $t('create') }}\n        <i class=\"el-icon-plus el-icon--right\" />\n      </el-button>\n    </el-card>\n    <el-table :data=\"showList\" class=\"hot-table\">\n      <el-table-column :label=\"$t('userName')\" prop=\"name\" />\n      <el-table-column :label=\"$t('action')\">\n        <template slot-scope=\" scope\">\n          <el-button :type=\"scope.row.enable ? 'success' : 'info'\" round class=\"btn\"\n            @click=\"itemChange(scope.row, false)\">\n            {{ scope.row.enable ? $t('enable') : $t('disenable') }}\n          </el-button>\n          <el-button type=\"primary\" icon=\"el-icon-edit\" circle @click=\"itemChange(scope.row, true)\" />\n        </template>\n      </el-table-column>\n    </el-table>\n    <create-role-edit-dialog ref=\"createRoleEditDialog\" @success=\"getPageData\" />\n    <authority-edit-dialog ref=\"authorityEditDialog\" @success=\"getPageData\" />\n    <div class=\"block\">\n      <el-pagination :current-page=\"pageIndex\" :page-size=\"pageSize\" :total=\"totalCount\"\n        layout=\"total, prev, pager, next, jumper\" @current-change=\"handleCurrentChange\" />\n    </div>\n  </div>\n</template>\n<script>\nimport createRoleEditDialog from './createRoleEditDialog'\nimport authorityEditDialog from './authorityEditDialog'\nimport { getRoleList, roleModify, roleSwitch, roleAdd } from '@/http/api/rolesApi'\nimport { getAuthorityList } from '@/http/api/authorityApi'\nexport default {\n  components: {\n    createRoleEditDialog,\n    authorityEditDialog\n  },\n  data () {\n    return {\n      disable: false,\n      pageIndex: 1,\n      pageSize: 10,\n      totalCount: 0,\n      allRoleList: [],\n      roleAuthority: {}\n    }\n  },\n  computed: {\n    showList () {\n      let { pageIndex, pageSize, allRoleList } = this\n      return allRoleList.slice((pageIndex - 1) * pageSize, pageIndex * pageSize)\n    }\n  },\n  mounted () {\n    this.getContent()\n  },\n  methods: {\n    getContent () {\n      getRoleList().then(res => {\n        this.allRoleList = res\n        this.totalCount = res.length\n      })\n    },\n    itemChange (...result) {\n      let { id, name, enable, version } = result[0]\n      if (result[1]) {\n        this.roleAuthority = {\n          rid: id,\n          name,\n          enable\n        }\n        getAuthorityList(id).then(res => {\n          this.$refs.authorityEditDialog.open(res)\n        })\n      } else {\n        let str = enable ? this.$t('CloseRole') : this.$t('OpenRole')\n        this.$confirm(str + '   ' + name)\n          .then(() => {\n            roleSwitch({ id, enable: !enable, name, version }).then(() => {\n              this.$message.success(enable ? this.$t('CloseRoleSuccess') : this.$t('OpenRoleSuccess'))\n              this.getContent(this.pageIndex)\n            })\n          })\n          .catch(err => {\n            this.$message.error(err.body.message)\n          })\n      }\n    },\n    handleCurrentChange (pageIndex) {\n      this.pageIndex = pageIndex\n      this.getContent(pageIndex)\n    },\n    getPageData (result) {\n      let { data, code } = result\n      if (code) {\n        roleModify({ ...this.roleAuthority, menuList: data })\n          .then(() => {\n            this.$message.success(this.$t('RoleAuthorization'))\n            this.getContent(this.pageIndex)\n          })\n          .catch(err => {\n            this.$message.error(err.body.message)\n          })\n      } else {\n        roleAdd(data)\n          .then(() => {\n            this.$message.success(this.$t('RoleCreate'))\n            this.getContent()\n          })\n          .catch(err => {\n            this.$message.error(err.body.message)\n          })\n      }\n    }\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n  .btn {\n    width: 90px;\n    line-height: 1;\n    &:focus {\n      outline: none;\n    }\n    span {\n      font-size: 14px;\n    }\n  }\n</style>\n"],"sourceRoot":"src/views/user/roles"}]}