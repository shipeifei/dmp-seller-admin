{"remainingRequest":"/Users/shizhonghua/workspace/sell/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shizhonghua/workspace/sell/src/views/sys/association/createEditDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/shizhonghua/workspace/sell/src/views/sys/association/createEditDialog.vue","mtime":1553649389000},{"path":"/Users/shizhonghua/workspace/sell/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shizhonghua/workspace/sell/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/shizhonghua/workspace/sell/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shizhonghua/workspace/sell/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport draggable from 'vuedraggable'\nimport { getProductCodeByName } from '@/http/api/platformApi.js'\nexport default {\n  components: {\n    draggable\n  },\n  data () {\n    return {\n      options: [],\n      platformArr: [],\n      dialog: {\n        title: this.$t('create'),\n        labelName: this.$t('create'),\n        buttonType: 'CREATE'\n      },\n      createForm: {\n        id: '',\n        mainProductId: '',\n        bu: '',\n        listDetails: [\n          {\n            subProductId: ''\n          }\n        ]\n      }\n    }\n  },\n  methods: {\n    removeDomain (item) {\n      let index = this.createForm.listDetails.indexOf(item)\n      this.createForm.listDetails.splice(index, 1)\n      this.$message.success(this.$t('Delsuccess'))\n    },\n    addDomain () {\n      this.createForm.listDetails.push({\n        subProductId: ''\n      })\n      this.$message.success(this.$t('Addsuccess'))\n    },\n    open (item) {\n      getProductCodeByName('').then(res => {\n        this.options = res\n      })\n      if (item) {\n        this.createForm = {\n          id: item.id,\n          mainProductId: item.mainProductId,\n          bu: item.bu,\n          listDetails: item.listDetails\n        }\n        this.dialog = {\n          title: this.$t('edit'),\n          labelName: this.$t('save'),\n          buttonType: 'UPDATE'\n        }\n      } else {\n        this.createForm = {\n          mainProductId: '',\n          bu: '',\n          listDetails: [\n            {\n              subProductId: ''\n            }\n          ]\n        }\n        this.dialog = {\n          title: this.$t('create'),\n          labelName: this.$t('create'),\n          buttonType: 'CREATE'\n        }\n      }\n      this.$refs.hotProductDialog.open()\n    },\n    onConfirmCreateType (formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          let flag = false\n          let obj = {}\n          if (!this.createForm.mainProductId) {\n            this.$message.error(this.$t('ProductNoempty'))\n            return false\n          }\n\n          this.createForm.listDetails.forEach(item => {\n            if (obj[item.subProductId]) {\n              this.$message.error(this.$t('ProductNorepeated'))\n              return (flag = true)\n            } else if (!item.subProductId) {\n              this.$message.error(this.$t('ProductNoempty'))\n              return (flag = true)\n            }\n            obj[item.subProductId] = 1\n          })\n          if (flag) {\n            return false\n          }\n          this.$refs.hotProductDialog.close()\n          if (this.dialog.buttonType === 'CREATE') {\n            this.$emit('success', { data: this.createForm, code: 0 })\n          } else {\n            this.$emit('success', { data: this.createForm, code: 1 })\n          }\n        } else {\n          return false\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["createEditDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"createEditDialog.vue","sourceRoot":"src/views/sys/association","sourcesContent":["<template>\n  <gucp-dialog\n    ref=\"hotProductDialog\"\n    :title=\"dialog.title\"\n    :confirm-label=\"dialog.labelName\"\n    width=\"60%\"\n    @confirm=\"onConfirmCreateType('createForm')\"\n  >\n    <el-form\n      ref=\"createForm\"\n      :model=\"createForm\"\n      :inline=\"true\"\n      label-suffix=\":\"\n      label-position=\"right\"\n      label-width=\"140px\"\n    >\n      <el-form-item :label=\"$t('mainProduct')\" prop=\"mainProductId\">\n        <el-input v-model=\"createForm.mainProductId\" />\n      </el-form-item>\n      <draggable v-model=\"createForm.listDetails\">\n        <div\n          v-for=\"(domain, index) in createForm.listDetails\"\n          :key=\"index\"\n          class=\"move-item\"\n        >\n          <el-form-item\n            :label=\"$t('relatedProducts') + (index + 1)\"\n            :prop=\"'createFormlistDetails' + index + 'subProductId'\"\n          >\n            <el-select\n              v-model=\"domain.subProductId\"\n              :placeholder=\"$t('pleaseChoose')\"\n              filterable\n              product\n            >\n              <el-option\n                v-for=\"item in options\"\n                :key=\"item.code\"\n                :label=\"item.codeName\"\n                :value=\"item.code\"\n              />\n            </el-select>\n            <i\n              v-if=\"index === 0\"\n              class=\"el-icon-circle-plus-outline icon\"\n              @click=\"addDomain\"\n            />\n            <i\n              v-else\n              class=\"el-icon-remove-outline icon\"\n              @click.prevent=\"removeDomain(domain)\"\n            />\n            <i class=\"el-icon-sort icon\" />\n          </el-form-item>\n        </div>\n      </draggable>\n    </el-form>\n  </gucp-dialog>\n</template>\n<script>\nimport draggable from 'vuedraggable'\nimport { getProductCodeByName } from '@/http/api/platformApi.js'\nexport default {\n  components: {\n    draggable\n  },\n  data () {\n    return {\n      options: [],\n      platformArr: [],\n      dialog: {\n        title: this.$t('create'),\n        labelName: this.$t('create'),\n        buttonType: 'CREATE'\n      },\n      createForm: {\n        id: '',\n        mainProductId: '',\n        bu: '',\n        listDetails: [\n          {\n            subProductId: ''\n          }\n        ]\n      }\n    }\n  },\n  methods: {\n    removeDomain (item) {\n      let index = this.createForm.listDetails.indexOf(item)\n      this.createForm.listDetails.splice(index, 1)\n      this.$message.success(this.$t('Delsuccess'))\n    },\n    addDomain () {\n      this.createForm.listDetails.push({\n        subProductId: ''\n      })\n      this.$message.success(this.$t('Addsuccess'))\n    },\n    open (item) {\n      getProductCodeByName('').then(res => {\n        this.options = res\n      })\n      if (item) {\n        this.createForm = {\n          id: item.id,\n          mainProductId: item.mainProductId,\n          bu: item.bu,\n          listDetails: item.listDetails\n        }\n        this.dialog = {\n          title: this.$t('edit'),\n          labelName: this.$t('save'),\n          buttonType: 'UPDATE'\n        }\n      } else {\n        this.createForm = {\n          mainProductId: '',\n          bu: '',\n          listDetails: [\n            {\n              subProductId: ''\n            }\n          ]\n        }\n        this.dialog = {\n          title: this.$t('create'),\n          labelName: this.$t('create'),\n          buttonType: 'CREATE'\n        }\n      }\n      this.$refs.hotProductDialog.open()\n    },\n    onConfirmCreateType (formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          let flag = false\n          let obj = {}\n          if (!this.createForm.mainProductId) {\n            this.$message.error(this.$t('ProductNoempty'))\n            return false\n          }\n\n          this.createForm.listDetails.forEach(item => {\n            if (obj[item.subProductId]) {\n              this.$message.error(this.$t('ProductNorepeated'))\n              return (flag = true)\n            } else if (!item.subProductId) {\n              this.$message.error(this.$t('ProductNoempty'))\n              return (flag = true)\n            }\n            obj[item.subProductId] = 1\n          })\n          if (flag) {\n            return false\n          }\n          this.$refs.hotProductDialog.close()\n          if (this.dialog.buttonType === 'CREATE') {\n            this.$emit('success', { data: this.createForm, code: 0 })\n          } else {\n            this.$emit('success', { data: this.createForm, code: 1 })\n          }\n        } else {\n          return false\n        }\n      })\n    }\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.move-item {\n  display: flex;\n  align-items: center;\n  height: 50px;\n}\n.icon {\n  font-size: 20px;\n  color: #90a4ae;\n  text-align: center;\n  margin-left: 8px;\n  margin-top: -8px;\n  cursor: pointer;\n}\n.el-textarea {\n  width: 500px;\n}\n.el-input,\n.el-select {\n  width: 150px;\n  padding: 0;\n  margin: 0;\n}\n</style>\n"]}]}